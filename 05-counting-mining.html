<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Library Carpentry: The Unix Shell: Counting and mining with the shell</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav library"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Library Carpentry" src="assets/images/library-logo.svg"></div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/05-counting-mining.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="assets/images/library-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Library Carpentry: The Unix Shell
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Library Carpentry: The Unix Shell
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Library Carpentry: The Unix Shell
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 39%" class="percentage">
    39%
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: 39%" aria-valuenow="39" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/05-counting-mining.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-intro-shell.html">1. What is the shell?</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-navigating-the-filesystem.html">2. Navigating the filesystem</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-working-with-files-and-folders.html">3. Working with files and directories</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-loops.html">4. Automating the tedious with loops</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Counting and mining with the shell
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#counting-and-mining-data">Counting and mining data</a></li>
<li><a href="#counting-and-sorting">Counting and sorting</a></li>
<li><a href="#mining-or-searching">Mining or searching</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-free-text.html">6. Working with free text</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-loops.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-free-text.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-loops.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Automating the
        </a>
        <a class="chapter-link float-end" href="06-free-text.html" rel="next">
          Next: Working with free... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Counting and mining with the shell</h1>
        <p>Last updated on 2024-02-23 |
        
        <a href="https://github.com/librarycarpentry/lc-shell/edit/main/episodes/05-counting-mining.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I count data?</li>
<li>How can I find data within files?</li>
<li>How can I combine existing commands to do new things?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Demonstrate counting lines, words, and characters with the shell
command wc and appropriate flags</li>
<li>Use strings to mine files and extract matched lines with the
shell</li>
<li>Create complex single line commands by combining shell commands and
regular expressions to mine files</li>
<li>Redirect a command’s output to a file.</li>
<li>Process a file instead of keyboard input using redirection.</li>
<li>Construct command pipelines with two or more stages.</li>
<li>Explain Unix’s ‘small pieces, loosely joined’ philosophy.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="counting-and-mining-data"><h2 class="section-heading">Counting and mining data<a class="anchor" aria-label="anchor" href="#counting-and-mining-data"></a>
</h2>
<hr class="half-width"><p>Now that you know how to navigate the shell, we will move onto
learning how to count and mine data using a few of the standard shell
commands. While these commands are unlikely to revolutionise your work
by themselves, they’re very versatile and will add to your foundation
for working in the shell and for learning to code. The commands also
replicate the sorts of uses library users might make of library
data.</p>
</section><section id="counting-and-sorting"><h2 class="section-heading">Counting and sorting<a class="anchor" aria-label="anchor" href="#counting-and-sorting"></a>
</h2>
<hr class="half-width"><p>We will begin by counting the contents of files using the Unix shell.
We can use the Unix shell to quickly generate counts from across files,
something that is tricky to achieve using the graphical user interfaces
of standard office suites.</p>
<p>Let’s start by navigating to the directory that contains our data
using the <code>cd</code> command:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> cd shell-lesson</span></code></pre>
</div>
<p>Remember, if at any time you are not sure where you are in your
directory structure, use the <code>pwd</code> command to find out:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> pwd</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/Users/riley/Desktop/shell-lesson</code></pre>
</div>
<p>And let’s just check what files are in the directory and how large
they are with <code>ls -lhS</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-lhS</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>total 139M
-rw-rw-r-- 1 riley staff 126M Jun 10  2015 2014-01_JA.tsv
-rw-r--r-- 1 riley staff 7.4M Jan 31 18:47 2014-01-31_JA-america.tsv
-rw-r--r-- 1 riley staff 3.6M Jan 31 18:47 2014-01-31_JA-africa.tsv
-rw-r--r-- 1 riley staff 1.4M Jan 31 18:47 2014-02-02_JA-britain.tsv
-rw-r--r-- 1 riley staff 598K Jan 31 18:47 gulliver.txt
-rw-r--r-- 1 riley staff 583K Feb  1 22:53 33504-0.txt
drwxr-xr-x 2 riley staff   68 Feb  2 00:58 backup</code></pre>
</div>
<p>In this episode we’ll focus on the dataset
<code>2014-01_JA.tsv</code>, that contains journal article metadata, and
the three <code>.tsv</code> files derived from the original dataset.
Each of these three <code>.tsv</code> files includes all data where a
keyword such as <code>africa</code> or <code>america</code> appears in
the ‘Title’ field of <code>2014-01_JA.tsv</code>.</p>
<div id="csv-and-tsv-files" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="csv-and-tsv-files" class="callout-inner">
<h3 class="callout-title">CSV and TSV Files<a class="anchor" aria-label="anchor" href="#csv-and-tsv-files"></a>
</h3>
<div class="callout-content">
<p>CSV (Comma-separated values) is a common plain text format for
storing tabular data, where each record occupies one line and the values
are separated by commas. TSV (Tab-separated values) is just the same
except that values are separated by tabs rather than commas.
Confusingly, CSV is sometimes used to refer to both CSV, TSV and
variations of them. The simplicity of the formats make them great for
exchange and archival. They are not bound to a specific program (unlike
Excel files, say, there is no <code>CSV</code> program, just lots and
lots of programs that support the format, including Excel by the way.),
and you wouldn’t have any problems opening a 40 year old file today if
you came across one.</p>
</div>
</div>
</div>
<!-- hm, reminds me of MARC -->
<p>First, let’s have a look at the largest data file, using the tools we
learned in <a href="03-working-with-files-and-folders.html">Reading
files</a>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> cat 2014-01_JA.tsv</span></code></pre>
</div>
<p>Like <code>829-0.txt</code> before, the whole dataset cascades by and
can’t really make any sense of that amount of text. To cancel this
on-going con<code>cat</code>enation, or indeed any process in the Unix
shell, press <kbd>Ctrl</kbd>+<kbd>C</kbd>.</p>
<p>In most data files a quick glimpse of the first few lines already
tells us a lot about the structure of the dataset, for example the
table/column headers:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> head <span class="at">-n</span> 3 2014-01_JA.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>File    Creator    Issue    Volume    Journal    ISSN    ID    Citation    Title    Place    Labe    Language    Publisher    Date
History_1a-rdf.tsv  Doolittle, W. E.  1 59  KIVA -ARIZONA-  0023-1940 (Uk)RN001571862 KIVA -ARIZONA- 59(1), 7-26. (1993)  A Method for Distinguishing between Prehistoric and Recent Water and Soil Control Features  xxu eng ARIZONA ARCHAEOLOGICAL AND HISTORICAL SOCIETY 1993
History_1a-rdf.tsv  Nelson, M. C. 1 59  KIVA -ARIZONA-  0023-1940 (Uk)RN001571874 KIVA -ARIZONA- 59(1), 27-48. (1993) Classic Mimbres Land Use in the Eastern Mimbres Region, Southwestern New Mexico xxu eng ARIZONA ARCHAEOLOGICAL AND HISTORICAL SOCIETY 1993
</code></pre>
</div>
<p>In the header, we can see the common metadata fields of academic
papers: <code>Creator</code>, <code>Issue</code>, <code>Citation</code>,
etc.</p>
<p>Next, let’s learn about a basic data analysis tool: <code>wc</code>
is the “word count” command: it counts the number of lines, words, and
bytes. Since we love the wildcard operator, let’s run the command
<code>wc *.tsv</code> to get counts for all the <code>.tsv</code> files
in the current directory (it takes a little time to complete):</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    13712    511261   3773660 2014-01-31_JA-africa.tsv
    27392   1049601   7731914 2014-01-31_JA-america.tsv
   507732  17606310 131122144 2014-01_JA.tsv
     5375    196999   1453418 2014-02-02_JA-britain.tsv
   554211  19364171 144081136 total</code></pre>
</div>
<p>The first three columns contains the number of lines, words and
bytes.</p>
<p>If we only have a handful of files to compare, it might be faster or
more convenient to just check with Microsoft Excel, OpenRefine or your
favourite text editor, but when we have tens, hundreds or thousands of
documents, the Unix shell has a clear speed advantage. The real power of
the shell comes from being able to combine commands and automate tasks,
though. We will touch upon this slightly.</p>
<p>For now, we’ll see how we can build a simple pipeline to find the
shortest file in terms of number of lines. We start by adding the
<code>-l</code> flag to get only the number of lines, not the number of
words and bytes:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> <span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    13712 2014-01-31_JA-africa.tsv
    27392 2014-01-31_JA-america.tsv
   507732 2014-01_JA.tsv
     5375 2014-02-02_JA-britain.tsv
   554211 total</code></pre>
</div>
<p>The <code>wc</code> command itself doesn’t have a flag to sort the
output, but as we’ll see, we can combine three different shell commands
to get what we want.</p>
<p>First, we have the <code>wc -l *.tsv</code> command. We will save the
output from this command in a new file. To do that, we <em>redirect</em>
the output from the command to a file using the ‘greater than’ sign
(&gt;), like so:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> <span class="pp">*</span>.tsv <span class="op">&gt;</span> lengths.txt</span></code></pre>
</div>
<p>There’s no output now since the output went into the file
<code>lengths.txt</code>, but we can check that the output indeed ended
up in the file using <code>cat</code> or <code>less</code> (or Notepad
or any text editor).</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> cat lengths.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    13712 2014-01-31_JA-africa.tsv
    27392 2014-01-31_JA-america.tsv
   507732 2014-01_JA.tsv
     5375 2014-02-02_JA-britain.tsv
   554211 total</code></pre>
</div>
<p>Next, there is the <code>sort</code> command. We’ll use the
<code>-n</code> flag to specify that we want numerical sorting, not
lexical sorting, we output the results into yet another file, and we use
<code>cat</code> to check the results:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">$</span> sort <span class="at">-n</span> lengths.txt <span class="op">&gt;</span> sorted-lengths.txt</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="ex">$</span> cat sorted-lengths.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     5375 2014-02-02_JA-britain.tsv
    13712 2014-01-31_JA-africa.tsv
    27392 2014-01-31_JA-america.tsv
   507732 2014-01_JA.tsv
   554211 total</code></pre>
</div>
<p>Finally we have our old friend <code>head</code>, that we can use to
get the first line of the <code>sorted-lengths.txt</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">$</span> head <span class="at">-n</span> 1 sorted-lengths.txt</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     5375 2014-02-02_JA-britain.tsv</code></pre>
</div>
<p>But we’re really just interested in the end result, not the
intermediate results now stored in <code>lengths.txt</code> and
<code>sorted-lengths.txt</code>. What if we could send the results from
the first command (<code>wc -l *.tsv</code>) directly to the next
command (<code>sort -n</code>) and then the output from that command to
<code>head -n 1</code>? Luckily we can, using a concept called pipes. On
the command line, you make a pipe with the vertical bar character
<code>|</code>. Let’s try with one pipe first:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     5375 2014-02-02_JA-britain.tsv
    13712 2014-01-31_JA-africa.tsv
    27392 2014-01-31_JA-america.tsv
   507732 2014-01_JA.tsv
   554211 total</code></pre>
</div>
<p>Notice that this is exactly the same output that ended up in our
<code>sorted-lengths.txt</code> earlier. Let’s add another pipe:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     5375 2014-02-02_JA-britain.tsv</code></pre>
</div>
<p>It can take some time to fully grasp pipes and use them efficiently,
but it’s a very powerful concept that you will find not only in the
shell, but also in most programming languages.</p>
<figure><img src="fig/redirects-and-pipes.png" alt="Redirects and Pipes" class="figure mx-auto d-block"></figure><div id="pipes-and-filters" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="pipes-and-filters" class="callout-inner">
<h3 class="callout-title">Pipes and Filters<a class="anchor" aria-label="anchor" href="#pipes-and-filters"></a>
</h3>
<div class="callout-content">
<p>This simple idea is why Unix has been so successful. Instead of
creating enormous programs that try to do many different things, Unix
programmers focus on creating lots of simple tools that each do one job
well, and that work well with each other. This programming model is
called “pipes and filters”. We’ve already seen pipes; a filter is a
program like <code>wc</code> or <code>sort</code> that transforms a
stream of input into a stream of output. Almost all of the standard Unix
tools can work this way: unless told to do otherwise, they read from
standard input, do something with what they’ve read, and write to
standard output.</p>
<p>The key is that any program that reads lines of text from standard
input and writes lines of text to standard output can be combined with
every other program that behaves this way as well. You can and should
write your programs this way so that you and other people can put those
programs into pipes to multiply their power.</p>
</div>
</div>
</div>
<!-- Copied from https://swcarpentry.github.io/shell-novice/04-pipefilter/ -->
<div id="adding-another-pipe" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="adding-another-pipe" class="callout-inner">
<h3 class="callout-title">Adding another pipe<a class="anchor" aria-label="anchor" href="#adding-another-pipe"></a>
</h3>
<div class="callout-content">
<p>We have our <code>wc -l *.tsv | sort -n | head -n 1</code> pipeline.
What would happen if you piped this into <code>cat</code>? Try it!</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The <code>cat</code> command just outputs whatever it gets as input,
so you get exactly the same output from</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1</span></code></pre>
</div>
<p>and</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">cat</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="count-the-number-of-words-sort-and-print-faded-example" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="count-the-number-of-words-sort-and-print-faded-example" class="callout-inner">
<h3 class="callout-title">Count the number of words, sort and print
(faded example)<a class="anchor" aria-label="anchor" href="#count-the-number-of-words-sort-and-print-faded-example"></a>
</h3>
<div class="callout-content">
<p>To count the total lines in every <code>tsv</code> file, sort the
results and then print the first line of the file we use the
following:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1</span></code></pre>
</div>
<p>Now let’s change the scenario. We want to know the 10 files that
contain <em>the most</em> words. Check the manual for the
<code>wc</code> command (either using <code>man wc</code> or
<code>wc --help</code>) to see if you can find out what flag to use to
print out the number of words (but not the number of lines and bytes).
Fill in the blanks below to count the words for each file, put them into
order, and then make an output of the 10 files with the most words
(Hint: The sort command sorts in ascending order by default).</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">wc</span> __ <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> __ <span class="kw">|</span> <span class="ex">____</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Here we use the <code>wc</code> command with the <code>-w</code>
(word) flag on all <code>tsv</code> files, <code>sort</code> them and
then output the last 11 lines (10 files and the total) using the
<code>tail</code> command.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-w</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 11</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="counting-number-of-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="counting-number-of-files" class="callout-inner">
<h3 class="callout-title">Counting number of files<a class="anchor" aria-label="anchor" href="#counting-number-of-files"></a>
</h3>
<div class="callout-content">
<p>Let’s make a different pipeline. You want to find out how many files
and directories there are in the current directory. Try to see if you
can pipe the output from <code>ls</code> into <code>wc</code> to find
the answer.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="writing-to-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="writing-to-files" class="callout-inner">
<h3 class="callout-title">Writing to files<a class="anchor" aria-label="anchor" href="#writing-to-files"></a>
</h3>
<div class="callout-content">
<p>The <code>date</code> command outputs the current date and time. Can
you write the current date and time to a new file called
<code>logfile.txt</code>? Then check the contents of the file.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="ex">$</span> date <span class="op">&gt;</span> logfile.txt</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="ex">$</span> cat logfile.txt</span></code></pre>
</div>
<p>To check the contents, you could also use <code>less</code> or many
other commands.</p>
<p>Beware that <code>&gt;</code> will happily overwrite an existing file
without warning you, so please be careful.</p>
</div>
</div>
</div>
</div>
<div id="appending-to-a-file" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="appending-to-a-file" class="callout-inner">
<h3 class="callout-title">Appending to a file<a class="anchor" aria-label="anchor" href="#appending-to-a-file"></a>
</h3>
<div class="callout-content">
<p>While <code>&gt;</code> writes to a file, <code>&gt;&gt;</code>
appends something to a file. Try to append the current date and time to
the file <code>logfile.txt</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">$</span> date <span class="op">&gt;&gt;</span> logfile.txt</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="ex">$</span> cat logfile.txt</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="counting-the-number-of-words" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="counting-the-number-of-words" class="callout-inner">
<h3 class="callout-title">Counting the number of words<a class="anchor" aria-label="anchor" href="#counting-the-number-of-words"></a>
</h3>
<div class="callout-content">
<p>We learned about the -w flag above, so now try using it with the
<code>.tsv</code> files.</p>
<p>If you have time, you can also try to sort the results by piping it
to <code>sort</code>. And/or explore the other flags of
<code>wc</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Show me the solution</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>From <code>man wc</code>, you will see that there is a
<code>-w</code> flag to print the number of words:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     -w      The number of words in each input file is written to the standard
             output.</code></pre>
</div>
<p>So to print the word counts of the <code>.tsv</code> files:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-w</span> <span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  511261 2014-01-31_JA-africa.tsv
 1049601 2014-01-31_JA-america.tsv
17606310 2014-01_JA.tsv
  196999 2014-02-02_JA-britain.tsv
19364171 total</code></pre>
</div>
<p>And to sort the lines numerically:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-w</span> <span class="pp">*</span>.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-n</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  196999 2014-02-02_JA-britain.tsv
  511261 2014-01-31_JA-africa.tsv
 1049601 2014-01-31_JA-america.tsv
17606310 2014-01_JA.tsv
19364171 total</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="mining-or-searching"><h2 class="section-heading">Mining or searching<a class="anchor" aria-label="anchor" href="#mining-or-searching"></a>
</h2>
<hr class="half-width"><p>Searching for something in one or more files is something we’ll often
need to do, so let’s introduce a command for doing that:
<code>grep</code> (short for <strong>global regular expression
print</strong>). As the name suggests, it supports regular expressions
and is therefore only limited by your imagination, the shape of your
data, and - when working with thousands or millions of files - the
processing power at your disposal.</p>
<p>To begin using <code>grep</code>, first navigate to the
<code>shell-lesson</code> directory if not already there. Then create a
new directory “results”:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="ex">$</span> mkdir results</span></code></pre>
</div>
<p>Now let’s try our first search:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="ex">$</span> grep 1999 <span class="pp">*</span>.tsv</span></code></pre>
</div>
<p>Remember that the shell will expand <code>*.tsv</code> to a list of
all the <code>.tsv</code> files in the directory. <code>grep</code> will
then search these for instances of the string “1999” and print the
matching lines.</p>
<div id="strings" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="strings" class="callout-inner">
<h3 class="callout-title">Strings<a class="anchor" aria-label="anchor" href="#strings"></a>
</h3>
<div class="callout-content">
<p>A string is a sequence of characters, or “a piece of text”.</p>
</div>
</div>
</div>
<p>Press the up arrow once in order to cycle back to your most recent
action. Amend <code>grep 1999 *.tsv</code> to
<code>grep -c 1999 *.tsv</code> and press enter.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-c</span> 1999 <span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2014-01-31_JA-africa.tsv:804
2014-01-31_JA-america.tsv:1478
2014-01_JA.tsv:28767
2014-02-02_JA-britain.tsv:284</code></pre>
</div>
<p>The shell now prints the number of times the string 1999 appeared in
each file. If you look at the output from the previous command, this
tends to refer to the date field for each journal article.</p>
<p>We will try another search:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-c</span> revolution <span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2014-01-31_JA-africa.tsv:20
2014-01-31_JA-america.tsv:34
2014-01_JA.tsv:867
2014-02-02_JA-britain.tsv:9</code></pre>
</div>
<p>We got back the counts of the instances of the string
<code>revolution</code> within the files. Now, amend the above command
to the below and observe how the output of each is different:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-ci</span> revolution <span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2014-01-31_JA-africa.tsv:118
2014-01-31_JA-america.tsv:1018
2014-01_JA.tsv:9327
2014-02-02_JA-britain.tsv:122</code></pre>
</div>
<p>This repeats the query, but prints a case insensitive count
(including instances of both <code>revolution</code> and
<code>Revolution</code> and other variants). Note how the count has
increased nearly 30 fold for those journal article titles that contain
the keyword ‘america’. As before, cycling back and adding
<code>&gt; results/</code>, followed by a filename (ideally in .txt
format), will save the results to a data file.</p>
<p>So far we have counted strings in files and printed to the shell or
to file those counts. But the real power of <code>grep</code> comes in
that you can also use it to create subsets of tabulated data (or indeed
any data) from one or multiple files.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-i</span> revolution <span class="pp">*</span>.tsv</span></code></pre>
</div>
<p>This script looks in the defined files and prints any lines
containing <code>revolution</code> (without regard to case) to the
shell. We let the shell add today’s date to the filename:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-i</span> revolution <span class="pp">*</span>.tsv <span class="op">&gt;</span> results/<span class="va">$(</span><span class="fu">date</span> <span class="st">"+%Y-%m-%d"</span><span class="va">)</span>_JAi-revolution.tsv</span></code></pre>
</div>
<p>This saves the subsetted data to a new file.</p>
<div id="alternative-date-commands" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="alternative-date-commands" class="callout-inner">
<h3 class="callout-title">Alternative date commands<a class="anchor" aria-label="anchor" href="#alternative-date-commands"></a>
</h3>
<div class="callout-content">
<p>This way of writing dates is so common that on most platforms you can
get the same result by typing <code>$(date -I)</code> instead of
<code>$(date "+%Y-%m-%d")</code>.</p>
</div>
</div>
</div>
<p>However, if we look at this file, it contains every instance of the
string ‘revolution’ including as a single word and as part of other
words such as ‘revolutionary’. This perhaps isn’t as useful as we
thought… Thankfully, the <code>-w</code> flag instructs
<code>grep</code> to look for whole words only, giving us greater
precision in our search.</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-iw</span> revolution <span class="pp">*</span>.tsv <span class="op">&gt;</span> results/<span class="va">$(</span><span class="fu">date</span> <span class="st">"+%Y-%m-%d"</span><span class="va">)</span>_JAiw-revolution.tsv</span></code></pre>
</div>
<p>This script looks in both of the defined files and exports any lines
containing the whole word <code>revolution</code> (without regard to
case) to the specified <code>.tsv</code> file.</p>
<p>We can show the difference between the files we created.</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="ex">$</span> wc <span class="at">-l</span> results/<span class="pp">*</span>.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   10585 2016-07-19_JAi-revolution.tsv
    7779 2016-07-19_JAiw-revolution.tsv
   18364 total</code></pre>
</div>
<div id="automatically-adding-a-date-prefix" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="automatically-adding-a-date-prefix" class="callout-inner">
<h3 class="callout-title">Automatically adding a date prefix<a class="anchor" aria-label="anchor" href="#automatically-adding-a-date-prefix"></a>
</h3>
<div class="callout-content">
<p>Notice how we didn’t type today’s date ourselves, but let the
<code>date</code> command do that mindless task for us. Find out about
the <code>"+%Y-%m-%d"</code> option and alternative options we could
have used.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">Show me the solution</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<p>Using <code>date --help</code> (on Git Bash for Windows or Linux) or
<code>man date</code> (on macOS or Linux) will show you that the
<code>+</code> option introduces a date format, where <code>%Y</code>,
<code>%m</code> and <code>%d</code> are replaced by the year, month, and
day respectively. There are many other percent-codes you could use.</p>
<p>You might also see that <code>-I</code> is short for <a href="https://en.wikipedia.org/wiki/ISO_8601" class="external-link">--iso-8601</a>, which
essentially avoids the confusion between the European and American date
formats <code>DD.MM.YYYY</code> and <code>MM/DD/YYYY</code>.</p>
</div>
</div>
</div>
</div>
<p>Finally, we’ll use the <strong>regular expression syntax</strong>
covered earlier to search for similar words.</p>
<div id="basic-extended-and-perl-compatible-regular-expressions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="basic-extended-and-perl-compatible-regular-expressions" class="callout-inner">
<h3 class="callout-title">Basic, extended, and PERL-compatible regular
expressions<a class="anchor" aria-label="anchor" href="#basic-extended-and-perl-compatible-regular-expressions"></a>
</h3>
<div class="callout-content">
<p>There are, unfortunately, <a href="https://www.gnu.org/software/grep/manual/html_node/Regular-Expressions.html" class="external-link">different
ways of writing regular expressions</a>. Across its various versions,
<code>grep</code> supports “basic”, at least two types of “extended”,
and “PERL-compatible” regular expressions. This is a common cause of
confusion, since most tutorials, including ours, teach regular
expressions compatible with the PERL programming language, but
<code>grep</code> uses basic by default. Unless you want to remember the
details, make your life easy by always using the most advanced regular
expressions your version of <code>grep</code> supports (<code>-E</code>
flag on macOS X, <code>-P</code> on most other platforms) or when doing
something more complex than searching for a plain string.</p>
</div>
</div>
</div>
<p>The regular expression ‘fr[ae]nc[eh]’ will match “france”, “french”,
but also “frence” and “franch”. It’s generally a good idea to enclose
the expression in single quotation marks, since that ensures the shell
sends it directly to grep without any processing (such as trying to
expand the wildcard operator *).</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-iwE</span> <span class="st">'fr[ae]nc[eh]'</span> <span class="pp">*</span>.tsv</span></code></pre>
</div>
<p>The shell will print out each matching line.</p>
<p>We include the <code>-o</code> flag to print only the matching part
of the lines e.g. (handy for isolating/checking results):</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-iwEo</span> <span class="st">'fr[ae]nc[eh]'</span> <span class="pp">*</span>.tsv</span></code></pre>
</div>
<p>Pair up with your neighbor and work on these exercises:</p>
<div id="case-sensitive-search" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="case-sensitive-search" class="callout-inner">
<h3 class="callout-title">Case sensitive search<a class="anchor" aria-label="anchor" href="#case-sensitive-search"></a>
</h3>
<div class="callout-content">
<p>Search for all case sensitive instances of a whole word you choose in
all four derived <code>.tsv</code> files in this directory. Print your
results to the shell.</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">Show me the solution</h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-w</span> hero <span class="pp">*</span>.tsv</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="case-sensitive-search-in-select-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="case-sensitive-search-in-select-files" class="callout-inner">
<h3 class="callout-title">Case sensitive search in select files<a class="anchor" aria-label="anchor" href="#case-sensitive-search-in-select-files"></a>
</h3>
<div class="callout-content">
<p>Search for all case sensitive instances of a word you choose in the
‘America’ and ‘Africa’ <code>.tsv</code> files in this directory. Print
your results to the shell.</p>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">Show me the solution</h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" data-bs-parent="#accordionSolution9" aria-labelledby="headingSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="ex">$</span> grep hero <span class="pp">*</span>a.tsv</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="count-words-case-sensitive" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="count-words-case-sensitive" class="callout-inner">
<h3 class="callout-title">Count words (case sensitive)<a class="anchor" aria-label="anchor" href="#count-words-case-sensitive"></a>
</h3>
<div class="callout-content">
<p>Count all case sensitive instances of a word you choose in the
‘America’ and ‘Africa’ <code>.tsv</code> files in this directory. Print
your results to the shell.</p>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">Show me the solution</h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" data-bs-parent="#accordionSolution10" aria-labelledby="headingSolution10">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-c</span> hero <span class="pp">*</span>a.tsv</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="count-words-case-insensitive" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="count-words-case-insensitive" class="callout-inner">
<h3 class="callout-title">Count words (case insensitive)<a class="anchor" aria-label="anchor" href="#count-words-case-insensitive"></a>
</h3>
<div class="callout-content">
<p>Count all case insensitive instances of that word in the ‘America’
and ‘Africa’ <code>.tsv</code> files in this directory. Print your
results to the shell.</p>
</div>
</div>
</div>
<div id="accordionSolution11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution11" aria-expanded="false" aria-controls="collapseSolution11">
  <h4 class="accordion-header" id="headingSolution11">Show me the solution</h4>
</button>
<div id="collapseSolution11" class="accordion-collapse collapse" data-bs-parent="#accordionSolution11" aria-labelledby="headingSolution11">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-ci</span> hero <span class="pp">*</span>a.tsv</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="case-insensitive-search-in-select-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="case-insensitive-search-in-select-files" class="callout-inner">
<h3 class="callout-title">Case insensitive search in select files<a class="anchor" aria-label="anchor" href="#case-insensitive-search-in-select-files"></a>
</h3>
<div class="callout-content">
<p>Search for all case insensitive instances of that word in the
‘America’ and ‘Africa’ <code>.tsv</code> files in this directory. Print
your results to a file <code>results/hero.tsv</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution12" aria-expanded="false" aria-controls="collapseSolution12">
  <h4 class="accordion-header" id="headingSolution12">Show me the solution</h4>
</button>
<div id="collapseSolution12" class="accordion-collapse collapse" data-bs-parent="#accordionSolution12" aria-labelledby="headingSolution12">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-i</span> hero <span class="pp">*</span>a.tsv <span class="op">&gt;</span> results/hero.tsv</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="case-insensitive-search-in-select-files-whole-word" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="case-insensitive-search-in-select-files-whole-word" class="callout-inner">
<h3 class="callout-title">Case insensitive search in select files (whole
word)<a class="anchor" aria-label="anchor" href="#case-insensitive-search-in-select-files-whole-word"></a>
</h3>
<div class="callout-content">
<p>Search for all case insensitive instances of that whole word in the
‘America’ and ‘Africa’ <code>.tsv</code> files in this directory. Print
your results to a file <code>results/hero-i.tsv</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution13" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution13" aria-expanded="false" aria-controls="collapseSolution13">
  <h4 class="accordion-header" id="headingSolution13">Show me the solution</h4>
</button>
<div id="collapseSolution13" class="accordion-collapse collapse" data-bs-parent="#accordionSolution13" aria-labelledby="headingSolution13">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-iw</span> hero <span class="pp">*</span>a.tsv <span class="op">&gt;</span> results/hero-i.tsv</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="searching-with-regular-expressions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="searching-with-regular-expressions" class="callout-inner">
<h3 class="callout-title">Searching with regular expressions<a class="anchor" aria-label="anchor" href="#searching-with-regular-expressions"></a>
</h3>
<div class="callout-content">
<p>Use regular expressions to find all ISSN numbers (four digits
followed by hyphen followed by four digits) in
<code>2014-01_JA.tsv</code> and print the results to a file
<code>results/issns.tsv</code>. Note that you might have to use the
<code>-E</code> flag (or <code>-P</code> with some versions of
<code>grep</code>, e.g. with Git Bash on Windows).</p>
</div>
</div>
</div>
<div id="accordionSolution14" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution14" aria-expanded="false" aria-controls="collapseSolution14">
  <h4 class="accordion-header" id="headingSolution14">Show me the solution</h4>
</button>
<div id="collapseSolution14" class="accordion-collapse collapse" data-bs-parent="#accordionSolution14" aria-labelledby="headingSolution14">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-Eo</span> <span class="st">'\d{4}-\d{4}'</span> 2014-01_JA.tsv <span class="op">&gt;</span> results/issns.tsv</span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-Po</span> <span class="st">'\d{4}-\d{4}'</span> 2014-01_JA.tsv <span class="op">&gt;</span> results/issns.tsv</span></code></pre>
</div>
<p>It is worth checking the file to make sure <code>grep</code> has
interpreted the pattern correctly. You could use the <code>less</code>
command for this.</p>
<p>The <code>-o</code> flag means that only the ISSN itself is printed
out, instead of the whole line.</p>
<p>If you came up with something more advanced, perhaps including word
boundaries, please share your result in the collaborative document and
give yourself a pat on the shoulder.</p>
</div>
</div>
</div>
</div>
<div id="finding-unique-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="finding-unique-values" class="callout-inner">
<h3 class="callout-title">Finding unique values<a class="anchor" aria-label="anchor" href="#finding-unique-values"></a>
</h3>
<div class="callout-content">
<p>If you pipe something to the <code>uniq</code> command, it will
filter out adjacent duplicate lines. In order for the ‘uniq’ command to
only return unique values though, it needs to be used with the ‘sort’
command. Try piping the output from the command in the last exercise to
<code>sort</code> and then piping these results to ‘uniq’ and then
<code>wc -l</code> to count the number of unique ISSN values.</p>
</div>
</div>
</div>
<div id="accordionSolution15" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution15" aria-expanded="false" aria-controls="collapseSolution15">
  <h4 class="accordion-header" id="headingSolution15">Show me the solution</h4>
</button>
<div id="collapseSolution15" class="accordion-collapse collapse" data-bs-parent="#accordionSolution15" aria-labelledby="headingSolution15">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-Eo</span> <span class="st">'\d{4}-\d{4}'</span> 2014-01_JA.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="ex">$</span> grep <span class="at">-Po</span> <span class="st">'\d{4}-\d{4}'</span> 2014-01_JA.tsv <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="using-a-loop-to-count-words">Using a Loop to Count Words<a class="anchor" aria-label="anchor" href="#using-a-loop-to-count-words"></a></h3>
<p>We will now use a loop to automate the counting of certain words
within a document. For this, we will be using the <em><a href="https://www.gutenberg.org/cache/epub/514/pg514.txt" class="external-link">Little
Women</a></em> e-book from <a href="https://www.gutenberg.org/" class="external-link">Project
Gutenberg</a>. The file is inside the <code>shell-lesson</code> folder
and named <code>pg514.txt</code>. Let’s rename the file to
<code>littlewomen.txt</code>.</p>
<pre><code>$ mv pg514.txt littlewomen.txt</code></pre>
<p>This renames the file to something easier to remember.</p>
<p>Now let’s create our loop. In the loop, we will ask the computer to
go through the text, looking for each girl’s name, and count the number
of times it appears. The results will print to the screen.</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="ex">$</span> for name in <span class="st">"Jo"</span> <span class="st">"Meg"</span> <span class="st">"Beth"</span> <span class="st">"Amy"</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="op">&gt;</span> do</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="op">&gt;</span>    echo <span class="st">"</span><span class="va">$name</span><span class="st">"</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="op">&gt;</span>    grep <span class="ex">-wo</span> <span class="st">"</span><span class="va">$name</span><span class="st">"</span> littlewomen.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a><span class="op">&gt;</span> done</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Jo</span></span>
<span><span class="fl">1355</span></span>
<span><span class="va">Meg</span></span>
<span><span class="fl">683</span></span>
<span><span class="va">Beth</span></span>
<span><span class="fl">459</span></span>
<span><span class="va">Amy</span></span>
<span><span class="fl">645</span></span></code></pre>
</div>
<p>What is happening in the loop?</p>
<ul><li>
<code>echo "$name"</code> is printing the current value of
<code>$name</code>
</li>
<li>
<code>grep "$name" littlewomen.txt</code> finds each line that
contains the value stored in <code>$name</code>. The <code>-w</code>
flag finds only the whole word that is the value stored in
<code>$name</code> and the <code>-o</code> flag pulls this value out
from the line it is in to give you the actual words to count as lines in
themselves.</li>
<li>The output from the <code>grep</code> command is redirected with the
pipe, <code>|</code> (without the pipe and the rest of the line, the
output from <code>grep</code> would print directly to the screen)</li>
<li>
<code>wc -l</code> counts the number of <em>lines</em> (because we
used the <code>-l</code> flag) sent from <code>grep</code>. Because
<code>grep</code> only returned lines that contained the value stored in
<code>$name</code>, <code>wc -l</code> corresponds to the number of
occurrences of each girl’s name.</li>
</ul><div id="why-are-the-variables-double-quoted-here" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="why-are-the-variables-double-quoted-here" class="callout-inner">
<h3 class="callout-title">Why are the variables double-quoted here?<a class="anchor" aria-label="anchor" href="#why-are-the-variables-double-quoted-here"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: lower-alpha"><li><p>In <a href="04-loops.html">episode 4</a> we learned to use
<code>"$..."</code> as a safeguard against white-space being
misinterpreted. Why <em>could</em> we omit the <code>"</code>-quotes in
the above example?</p></li>
<li><p>What happens if you add <code>"Louisa May Alcott"</code> to the
first line of the loop and remove the <code>"</code> from
<code>$name</code> in the loop’s code?</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution16" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution16" aria-expanded="false" aria-controls="collapseSolution16">
  <h4 class="accordion-header" id="headingSolution16">Solutions</h4>
</button>
<div id="collapseSolution16" class="accordion-collapse collapse" data-bs-parent="#accordionSolution16" aria-labelledby="headingSolution16">
<div class="accordion-body">
<ol style="list-style-type: lower-alpha"><li><p>Because we are explicitly listing the names after
<code>in</code>, and those contain no white-space. However, for
consistency it’s better to use rather once too often than once too
rarely.</p></li>
<li><p>Without <code>"</code>-quoting <code>$name</code>, the last loop
will try to execute <code>grep Louisa May Alcott littlewomen.txt</code>.
<code>grep</code> interprets only the first word as the search pattern,
but <code>May</code> and <code>Alcott</code> as filenames. This produces
two errors and a possibly untrustworthy count:</p></li>
</ol><div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="ex">Louisa</span> May Alcott</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a><span class="ex">grep:</span> May: No such file or directory</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a><span class="ex">grep:</span> Alcott: No such file or directory</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a><span class="ex">4</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="selecting-columns-from-our-article-dataset" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="selecting-columns-from-our-article-dataset" class="callout-inner">
<h3 class="callout-title">Selecting columns from our article
dataset<a class="anchor" aria-label="anchor" href="#selecting-columns-from-our-article-dataset"></a>
</h3>
<div class="callout-content">
<p>When you receive data it will often contain more columns or variables
than you need for your work. If you want to select only the columns you
need for your analysis, you can use the <code>cut</code> command to do
so. <code>cut</code> is a tool for extracting sections from a file. For
instance, say we want to retain only the <code>Creator</code>,
<code>Volume</code>, <code>Journal</code>, and <code>Citation</code>
columns from our article data. With <code>cut</code> we’d:</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">cut</span> <span class="at">-f</span> 2,4,5,8 2014-01_JA.tsv <span class="kw">|</span> <span class="fu">head</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Creator	Volume	Journal	Citation
Doolittle, W. E.  59  KIVA -ARIZONA-  KIVA -ARIZONA- 59(1), 7-26. (1993)
Nelson, M. C.	59	KIVA -ARIZONA-	KIVA -ARIZONA- 59(1), 27-48. (1993)
Deegan, A. C.	59	KIVA -ARIZONA-	KIVA -ARIZONA- 59(1), 49-64. (1993)
Stone, T.	59	KIVA -ARIZONA-	KIVA -ARIZONA- 59(1), 65-82. (1993)
Adams, W. Y.	1	NORTHEAST AFRICAN STUDIES	NORTHEAST AFRICAN STUDIES 1(2/3), 7-18. (1994)
Beswick, S. F.	1	NORTHEAST AFRICAN STUDIES	NORTHEAST AFRICAN STUDIES 1(2/3), 19-48. (1994)
Cheeseboro, A. Q.	1	NORTHEAST AFRICAN STUDIES	NORTHEAST AFRICAN STUDIES 1(2/3), 49-74. (1994)
Duany, W.	1	NORTHEAST AFRICAN STUDIES	NORTHEAST AFRICAN STUDIES 1(2/3), 75-102. (1994)
Mohamed Ibrahim Khalil	1	NORTHEAST AFRICAN STUDIES	NORTHEAST AFRICAN STUDIES 1(2/3), 103-118. (1994)</code></pre>
</div>
<p>Above we used <code>cut</code> and the <code>-f</code> flag to
indicate which columns we want to retain. <code>cut</code> works on tab
delimited files by default. We can use the flag <code>-d</code> to
change this to a comma, or semicolon or another delimiter. If you are
unsure of your column position and the file has headers on the first
line, we can use <code>head -n 1 &lt;filename&gt;</code> to print those
out.</p>
<div class="section level3">
<h3 id="now-your-turn">Now your turn<a class="anchor" aria-label="anchor" href="#now-your-turn"></a></h3>
<p>Select the columns <code>Issue</code>, <code>Volume</code>,
<code>Language</code>, <code>Publisher</code> and direct the output into
a new file. You can name it something like
<code>2014-01_JA_ivlp.tsv</code>.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution17" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution17" aria-expanded="false" aria-controls="collapseSolution17">
  <h4 class="accordion-header" id="headingSolution17">Show me the solution</h4>
</button>
<div id="collapseSolution17" class="accordion-collapse collapse" data-bs-parent="#accordionSolution17" aria-labelledby="headingSolution17">
<div class="accordion-body">
<p>First, let’s see where our desired columns are:</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 1 2014-01_JA.tsv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>File	Creator	Issue	Volume	Journal	ISSN	ID	Citation	Title	Place Labe	Language	Publisher	Date</code></pre>
</div>
<p>Ok, now we know <code>Issue</code> is column 3, <code>Volume</code>
4, <code>Language</code> 11, and <code>Publisher</code> 12. We use these
positional column numbers to construct our <code>cut</code> command:</p>
<pre><code>cut -f 3,4,11,12 2014-01_JA.tsv &gt; 2014-01_JA_ivlp.tsv</code></pre>
<p>We can confirm this worked by running head on the file:</p>
<pre><code>head 2014-01_JA_ivlp.tsv</code></pre>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Issue	Volume	Language	Publisher
1	59	eng	ARIZONA ARCHAEOLOGICAL AND HISTORICAL SOCIETY
1	59	eng	ARIZONA ARCHAEOLOGICAL AND HISTORICAL SOCIETY
1	59	eng	ARIZONA ARCHAEOLOGICAL AND HISTORICAL SOCIETY
1	59	eng	ARIZONA ARCHAEOLOGICAL AND HISTORICAL SOCIETY</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>The shell can be used to count elements of documents</li>
<li>The shell can be used to search for patterns within files</li>
<li>Commands can be used to count and mine any number of files</li>
<li>Commands and flags can be combined to build complex queries specific
to your work</li>
</ul></div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-loops.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-free-text.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-loops.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Automating the
        </a>
        <a class="chapter-link float-end" href="06-free-text.html" rel="next">
          Next: Working with free... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/librarycarpentry/lc-shell/edit/main/episodes/05-counting-mining.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/librarycarpentry/lc-shell/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/librarycarpentry/lc-shell/" class="external-link">Source</a></p>
				<p><a href="https://github.com/librarycarpentry/lc-shell/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://librarycarpentry.github.io/lc-shell/05-counting-mining.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Counting and mining with the shell",
  "creativeWorkStatus": "active",
  "url": "https://librarycarpentry.github.io/lc-shell/05-counting-mining.html",
  "identifier": "https://librarycarpentry.github.io/lc-shell/05-counting-mining.html",
  "dateCreated": "2018-04-12",
  "dateModified": "2024-02-23",
  "datePublished": "2024-05-07"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

